import{_ as R,H as g}from"./hls-CS45FAGB.js";import{s as T,h as $,p as M,C as A,E as w,d as B,k as I,i as U,c as k,a as e,b as C,w as t,r as c,u as r,e as q,f as d,t as u,o as x,_ as J}from"./index-CXCzEs_M.js";import{u as L,a as O}from"./Security-J1jS0fmJ.js";import"./swiper-BcqIYeZH.js";const V=L(),W=T("sharevideo",()=>{const h=$({}),_=M(),s=A();function S(){const p=s.params.share_id;if(console.log(p),p==null){_.replace({name:"/"});return}O({method:"post",url:"/api/share.php",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{data:V.encrypt(new URLSearchParams({share_id:p}).toString())}}).then(m=>{let l=JSON.parse(V.decrypt(m.data));l.code==1&&(h.value=l.data),l.code==2&&w.error(l.msg),l.code==3&&(w.error(l.msg),_.replace({name:"/"}))}).catch(m=>{w.error("网络错误")})}return{item:h,ShareVideoData:S}}),Y={class:"video-details",ref:"videoContent"},j={class:"video-content"},z=["poster","data-src","data-type","src"],G={key:0},K=B({__name:"sharevideo",setup(h){const _=M(),s=W();let S=$(null);I(()=>{S.value=document.documentElement.clientHeight,s.ShareVideoData()});const p=o=>{const n=Math.floor(o/1e3),f=Math.floor(n/3600),i=n%3600,a=Math.floor(i/60),y=i%60;return`${f.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${y.toString().padStart(2,"0")}`},m=o=>o>1e4?(o/1e4).toFixed(1)+"w":o,l=o=>{const n=new Date(o),f=n.getFullYear(),i=n.getMonth()+1,a=n.getDate();return`${f}-${i}-${a}`},D=()=>{const o=document.querySelector(".videoplayer");if(o)if(g.isSupported()&&o.dataset.type==="m3u8"){const n=new g;n.loadSource(o.dataset.src),n.attachMedia(o),n.on(g.Events.MANIFEST_PARSED,()=>{o.play()})}else o.src===""&&(o.src=o.dataset.src),o.play()};return U(()=>{D()}),(o,n)=>{const f=c("House"),i=c("el-icon"),a=c("el-col"),y=c("User"),v=c("el-row"),E=c("el-affix"),N=c("VideoPlay"),H=c("Star"),P=c("Film"),b=c("Clock");return x(),k("div",Y,[e(E,null,{default:t(()=>[e(v,{class:"video-header-row"},{default:t(()=>[e(a,{span:12,class:"video-back"},{default:t(()=>[e(i,{class:"video-back-icon",onClick:n[0]||(n[0]=F=>r(_).replace({path:"/"}))},{default:t(()=>[e(f)]),_:1})]),_:1}),e(a,{span:12,class:"video-star"},{default:t(()=>[e(i,{class:"video-back-icon",onClick:n[1]||(n[1]=F=>r(_).replace({path:"/user"}))},{default:t(()=>[e(y)]),_:1})]),_:1})]),_:1})]),_:1}),C("div",j,[C("video",{class:"videoplayer",ref:"videoplayer",width:"100%",preload:"auto",disablePictureInPicture:"true",controlslist:"nodownload noplaybackrate",poster:r(s).item.cover||"","data-src":r(s).item.video_url||"","data-type":r(s).item.video_url&&r(s).item.video_url.endsWith(".ts")?"m3u8":"mp4",src:r(s).item.video_url||"",muted:"",autoplay:"",loop:"",controls:""},null,8,z),e(v,null,{default:t(()=>[e(a,{span:24,class:"video-username"},{default:t(()=>[r(s).item.author!=""?(x(),k("span",G,"@")):q("",!0),d(" "+u(r(s).item.author),1)]),_:1})]),_:1}),e(v,null,{default:t(()=>[e(a,{span:24,class:"video-title"},{default:t(()=>[d(u(r(s).item.caption),1)]),_:1})]),_:1}),e(v,{class:"video-item-row"},{default:t(()=>[e(a,{class:"video-item-info",span:1},{default:t(()=>[e(i,null,{default:t(()=>[e(N)]),_:1})]),_:1}),e(a,{class:"video-item-info",span:3},{default:t(()=>[d(u(m(r(s).item.play_count)),1)]),_:1}),e(a,{class:"video-item-info",span:1},{default:t(()=>[e(i,null,{default:t(()=>[e(H)]),_:1})]),_:1}),e(a,{class:"video-item-info",span:3},{default:t(()=>[d(u(m(r(s).item.collect_count)),1)]),_:1}),e(a,{class:"video-item-info",span:1},{default:t(()=>[e(i,null,{default:t(()=>[e(P)]),_:1})]),_:1}),e(a,{class:"video-item-info",span:4},{default:t(()=>[d(u(p(r(s).item.duration)),1)]),_:1}),e(a,{class:"video-item-info",span:1},{default:t(()=>[e(i,null,{default:t(()=>[e(b)]),_:1})]),_:1}),e(a,{class:"video-item-info",span:5},{default:t(()=>[d(u(l(r(s).item.create_time)),1)]),_:1})]),_:1}),e(v,{class:"video-ad"},{default:t(()=>[e(a,{span:24},{default:t(()=>[e(R)]),_:1})]),_:1})])],512)}}}),te=J(K,[["__scopeId","data-v-4aed4307"]]);export{te as default};
